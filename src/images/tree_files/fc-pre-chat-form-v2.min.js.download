window.fcPreChatform={chatCustomData:{userCreated:!1,userOnLoad:!1,userCreatedfromTrigger:!1,userCreatedfromForm:!1,formCreated:!1},addCss:function(e){var t=document.head,o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,t.appendChild(o)},generateOptions:function(e){for(var t='<option value="">...</option>',o=0;o<e.options.length;o++)t+='<option value="'+e.options[o]+'">'+e.options[o]+"</option>";return t},generatePreChatHTML:function(e){for(var t='<div class="chat-fc-form-outer"><p class="fc-header">'+(void 0===e?"Freshchat":e.heading)+'<span class="fc-minimize" onclick="fcPreChatform.on_fc_pre_form_close()" aria-label="Close">X</span></p><div class="fc-form" dir="auto"><p>'+(void 0===e?"We can't wait to talk to you. But first, please take a couple of moments to tell us a bit about yourself.":e.textBanner)+'</p><form class="chat-fc-form"><ul>',o='</ul></form><a href="#" class="fc-button" onclick="fcPreChatform.on_fc_pre_form_submit(); return false;">'+(void 0===e?"Submit":e.SubmitLabel)+"</a></div></div>",r=e.fields,s=Object.keys(r),i="",a=0;a<s.length;a++)a<=4&&(i+='<li class="pre-fc-field"><label>'+r[s[a]].label+"<span>"+("yes"===r[s[a]].required?" *":"")+"</span></label><"+("dropdown"===r[s[a]].type?"select ":"input ")+'type="'+("phone"===r[s[a]].type?"text":r[s[a]].type)+("name"===r[s[a]].type?"text":r[s[a]].type)+'" id="chat-fc-'+r[s[a]].label.replace(/ /g,"").toLowerCase()+'" '+("dropdown"===r[s[a]].type?"onChange":"onBlur")+'="fcPreChatform.fc_validate_on_blur(event);" '+("yes"===r[s[a]].required?"required ":"")+("phone"===r[s[a]].type?'pattern="^(\\(?\\+[0-9]{0,3}\\)?)?(-? ?[0-9]){7,15}$"':"")+("name"===r[s[a]].type?'pattern=".*[^ ].*"':"")+("email"===r[s[a]].type?'pattern="^[a-zA-Z0-9_+&*\\-]+(?:\\.[a-zA-Z0-9_+&*\\-]+)*@(?:[a-zA-Z0-9\\-]+\\.)+[a-zA-Z]{2,7}$"':"")+"/>"+("dropdown"===r[s[a]].type?this.generateOptions(r[s[a]]):"")+"</"+("dropdown"===r[s[a]].type?"select":"input")+'><div class="pre-fc-error fc-hide" id="chat-fc-'+r[s[a]].label.replace(/ /g,"").toLowerCase()+'-error">'+r[s[a]].error+"</div></li>");return t+i+o},createPreChatForm:function(e,t){if(document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="hidden",!1===this.chatCustomData.formCreated){var o=document.createElement("div");o.innerHTML=t,document.body.appendChild(o.children[0]),document.querySelector(".chat-fc-form-outer p.fc-header").style.backgroundColor=void 0!==e.mainbgColor?e.mainbgColor:"",document.querySelector(".chat-fc-form-outer .fc-button").style.backgroundColor=void 0!==e.mainbgColor?e.mainbgColor:"",document.querySelector(".chat-fc-form-outer p.fc-header").style.color=void 0!==e.mainbgColor?e.maintxColor:"",document.querySelector(".chat-fc-form-outer .fc-button").style.color=void 0!==e.mainbgColor?e.maintxColor:"",this.chatCustomData.formCreated=!0}else document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="hidden",null!==document.querySelector(".chat-fc-form-outer")&&(document.querySelector(".chat-fc-form-outer").style.visibility="visible");setTimeout((()=>{let e=document.querySelector("li.pre-fc-field input");e?.focus()}),100)},clearPreChatForm:function(){for(var e=Object.keys(this.fields),t=0;t<e.length;t++)if(t<=4){var o=this.fields[e[t]].label.replace(/ /g,"").toLowerCase(),r=document.getElementById("chat-fc-"+o);r&&(r.value="")}},fcWidgetInit:function(e){var t=this;this.addCss("https://snippets.freshchat.com/css/fc-pre-chat-form-v2.css");var o=this.generatePreChatHTML(e);this.fields=e.fields,this.authenticateUser=e.authenticateUser,window.fcWidget.on("user:created",(function(t){!1===t.success?console.log("User Not Created"):!0===t.success&&null===t.data?(console.log("User Exists on Load"),"enabled"===e.classicLiveChatMode&&window.fcWidget.user.clear((function(e){console.log("User will be cleared")}))):3===Object.keys(t.data).length&&console.log("User Created")})),window.fcWidget.on("widget:opened",(function(r){if("enabled"===(e.workWithAwayExperience?e.workWithAwayExperience:"null")){var s="HH:mm:ss",i=moment().utc().format("dddd"),a=(moment().utc(),moment().utc().format(s));if(void 0!==e.business_hours_config[i]){var c=moment(e.business_hours_config[i].from,["h:mm A"]),n=moment(e.business_hours_config[i].to,["h:mm A"]),l=moment(e.business_hours_config[i].from,["h:mm A"]).format(s),d=moment(e.business_hours_config[i].to,["h:mm A"]).format(s),m=moment(a,s),u=moment(l,s),f=moment(d,s);!0===m.isBetween(u,f)&&!0===moment(moment()).isBetween(c,n)?(console.log("Within Business Hours"),window.fcWidget.user.isExists((function(r){!1===r.data?(t.chatCustomData.userCreated=!1,document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="hidden",t.createPreChatForm(e,o)):(t.chatCustomData.userCreated=!0,window.fcWidget.user.get((function(r){!0===r.data.isNameGenerated?t.createPreChatForm(e,o):(document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="visible",null!==document.querySelector(".chat-fc-form-outer")&&(document.querySelector(".chat-fc-form-outer").style.visibility="hidden"))})))}))):(console.log("Outside Business Hours"),document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="visible")}else console.log("Business Hours Not Configured for "+i+" so widget will be always shown"),document.querySelector("."+window.fcSettings.config.cssNames.widget).style.visibility="visible"}else window.fcWidget.user.isExists((function(r){!1===r.data?(t.chatCustomData.userCreated=!1,document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="hidden",t.createPreChatForm(e,o)):(t.chatCustomData.userCreated=!0,window.fcWidget.user.get((function(r){!0===r.data.isNameGenerated?t.createPreChatForm(e,o):(document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="visible",null!==document.querySelector(".chat-fc-form-outer")&&(document.querySelector(".chat-fc-form-outer").style.visibility="hidden"))})))}))})),this.authenticateUser&&window.fcWidget.on("user:cleared",(function(e){console.log("User Cleared"),t.clearPreChatForm()}))},on_fc_pre_form_submit:function(){var e=this,t=document.querySelector(".chat-fc-form");if(t.classList.add("submitted"),t.checkValidity()){var o=document.querySelector(".chat-fc-form-outer .fc-button");o.classList.add("submitted");for(var r=Object.keys(e.fields),s=[],i=[],a=0;a<r.length;a++)a<=4&&(void 0===e.fields[r[a]].fieldId?("name"===e.fields[r[a]].label.replace(/ /g,"").toLowerCase()||"firstname"===e.fields[r[a]].label.replace(/ /g,"").toLowerCase()?s.push("firstName"):"lastname"===e.fields[r[a]].label.replace(/ /g,"").toLowerCase()?s.push("lastName"):s.push(e.fields[r[a]].label.replace(/ /g,"").toLowerCase()),i.push(document.getElementById("chat-fc-"+e.fields[r[a]].label.replace(/ /g,"").toLowerCase()).value)):("name"===e.fields[r[a]].fieldId.replace(/ /g,"").toLowerCase()||"firstname"===e.fields[r[a]].fieldId.replace(/ /g,"").toLowerCase()?s.push("firstName"):"lastname"===e.fields[r[a]].fieldId.replace(/ /g,"").toLowerCase()?s.push("lastName"):s.push(e.fields[r[a]].fieldId.replace(/ /g,"").toLowerCase()),i.push(document.getElementById("chat-fc-"+e.fields[r[a]].label.replace(/ /g,"").toLowerCase()).value)));var c={};for(a=0;a<s.length;a++)c[s[a]]=i[a];for(a=0;a<Object.keys(c).length;a++)""===c[Object.keys(c)[a]]?delete c[Object.keys(c)[a]]:c[Object.keys(c)[a]];e.preChatFormUserData={},c.firstName&&(e.preChatFormUserData.first_name=c.firstName),c.lastName&&(e.preChatFormUserData.last_name=c.lastName),c.email&&(e.preChatFormUserData.email=c.email),c.phone&&(e.preChatFormUserData.phone_number=c.phone),c.title&&(e.preChatFormUserData.title=c.title),c.plan&&(e.preChatFormUserData.plan=c.plan),window.fcWidget.user.setProperties(c,(function(r){!0===r.success?(e.authenticateUser&&e.authenticateUser(e.preChatFormUserData),e.chatCustomData.userCreated=!0,document.querySelector(".chat-fc-form-outer").style.visibility="hidden",document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="visible",o.classList.remove("submitted"),t.classList.remove("submitted")):(o.classList.remove("submitted"),console.log("error setting user properties"))}))}else this.fc_validate_on_submit()},fc_validate_on_blur:function(e){var t=e.target.id,o=t+"-error";"change"!==e.type?""===document.getElementById(t).value?(document.getElementById(o).style.display="none",document.getElementById(t).style.borderColor="#ddd"):!1===document.getElementById(t).checkValidity()?document.getElementById(o).style.display="block":(document.getElementById(o).style.display="none",document.getElementById(t).style.borderColor="#ddd"):""===document.getElementById(t).value.trim()?!1===document.getElementById(t).checkValidity()&&(document.getElementById(o).style.display="block"):(document.getElementById(o).style.display="none",document.getElementById(t).style.borderColor="#ddd")},fc_validate_on_submit:function(){for(var e=Object.keys(this.fields),t=[],o=0;o<e.length;o++)o<=4&&"yes"===this.fields[e[o]].required&&t.push(this.fields[e[o]].label.replace(/ /g,"").toLowerCase());for(o=0;o<t.length;o++){var r="chat-fc-"+t[o],s="chat-fc-"+t[o]+"-error";""===document.getElementById(r).value||""===document.getElementById(r).value.trim()||!1===document.getElementById(r).checkValidity()?(document.getElementById(s).style.display="block",document.getElementById(r).style.borderColor="red"):(document.getElementById(s).style.display="none",document.getElementById(r).style.borderColor="#ddd")}},on_fc_pre_form_close:function(){window.fcWidget.close(),setTimeout((()=>{document.querySelector(".chat-fc-form-outer").style.visibility="hidden",document.querySelector("."+window.fcSettings.config.cssNames.widget+" iframe").style.visibility="visible"}),100)}};